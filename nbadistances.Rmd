---
title: "nbaplayers"
author: "Ian Thorpe"
date: "4/26/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(car)
```


```{r}
player_data <- read.csv('final_df.csv') %>%
  na.omit()
```

```{r}
center_data <- player_data %>%
  filter(POS == 'C') %>%
  select(c(raptor_offense, raptor_defense))

center_means <- colMeans(center_data)
center_cov <- cov(center_data)

n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05



t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
```

