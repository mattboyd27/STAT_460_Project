home_ml <- mean(rpois(10000, home_exp_pts) > rpois(10000, away_exp_pts))
away_ml <- mean(rpois(10000, home_exp_pts) < rpois(10000, away_exp_pts))
ml_tie <- mean(rpois(10000, home_exp_pts) == rpois(10000, away_exp_pts))/2
home_ml <- home_ml+ml_tie
away_ml <- away_ml+ml_tie
home_cover <- mean(rpois(10000, home_exp_pts) + spread > rpois(10000, away_exp_pts))
away_cover <- mean(rpois(10000, home_exp_pts) + spread < rpois(10000, away_exp_pts))
cover_tie <- mean(rpois(10000, home_exp_pts) + spread == rpois(10000, away_exp_pts))/2
home_cover <- home_cover + cover_tie
away_cover <- away_cover + cover_tie
over_prob <- mean(rpois(10000, home_exp_pts+away_exp_pts) > total)
under_prob <- mean(rpois(10000, home_exp_pts+away_exp_pts) < total)
total_tie <- mean(rpois(10000, home_exp_pts+away_exp_pts) == total)/2
over_prob <- over_prob + total_tie
under_prob <- under_prob + total_tie
cat(home_team, 'wins', round(home_ml*100, 2), '% of the time \n')
cat(away_team, 'wins', round(away_ml*100, 2), '% of the time \n')
cat(home_team, 'covers', round(home_cover*100, 2), '% of the time \n')
cat(away_team, 'covers', round(away_cover*100, 2), '% of the time \n')
cat('Total goes over', round(over_prob*100, 2), '% of the time \n')
cat('Total goes under', round(under_prob*100, 2), '% of the time \n')
}
nba_pred('Charlotte Hornets', 'Orlando Magic', -13.5, 227.5)
nba_pred = function(home_team, away_team, spread = 0, total = 0) {
nba_data %>%
filter(Away == away_team) %>%
summarise(avg_pts_visit = sum(Away_Score)/n(),
avg_ptsa_visit = sum(Home_Score)/n()) -> away_data
nba_data %>%
filter(Home == home_team) %>%
summarise(avg_pts_home = sum(Home_Score)/n(),
avg_ptsa_home = sum(Away_Score)/n()) -> home_data
avg_pts_home_league <- mean(nba_data$Home_Score)
avg_pts_away_league <- mean(nba_data$Away_Score)
home_attack <- home_data$avg_pts_home/avg_pts_home_league
away_attack <- away_data$avg_pts_visit/avg_pts_away_league
home_defense <- home_data$avg_ptsa_home/avg_pts_away_league
away_defense <- away_data$avg_ptsa_visit/avg_pts_home_league
home_exp_pts <- home_attack * away_defense * avg_pts_home_league
away_exp_pts <- away_attack * home_defense * avg_pts_away_league
cat(home_team, 'expPts:', round(home_exp_pts, 0), ' ', away_team, 'expPts:', round(away_exp_pts, 0), '\n')
home_ml <- mean(rpois(10000, home_exp_pts) > rpois(10000, away_exp_pts))
away_ml <- mean(rpois(10000, home_exp_pts) < rpois(10000, away_exp_pts))
ml_tie <- mean(rpois(10000, home_exp_pts) == rpois(10000, away_exp_pts))/2
home_ml <- home_ml+ml_tie
away_ml <- away_ml+ml_tie
home_cover <- mean(rpois(10000, home_exp_pts) + spread > rpois(10000, away_exp_pts))
away_cover <- mean(rpois(10000, home_exp_pts) + spread < rpois(10000, away_exp_pts))
cover_tie <- mean(rpois(10000, home_exp_pts) + spread == rpois(10000, away_exp_pts))/2
home_cover <- home_cover + cover_tie
away_cover <- away_cover + cover_tie
over_prob <- mean(rpois(10000, home_exp_pts+away_exp_pts) > total)
under_prob <- mean(rpois(10000, home_exp_pts+away_exp_pts) < total)
total_tie <- mean(rpois(10000, home_exp_pts+away_exp_pts) == total)/2
over_prob <- over_prob + total_tie
under_prob <- under_prob + total_tie
cat(home_team, 'win', round(home_ml*100, 2), '% of the time \n')
cat(away_team, 'win', round(away_ml*100, 2), '% of the time \n')
cat(home_team, 'cover', round(home_cover*100, 2), '% of the time \n')
cat(away_team, 'cover', round(away_cover*100, 2), '% of the time \n')
cat('Total goes over', round(over_prob*100, 2), '% of the time \n')
cat('Total goes under', round(under_prob*100, 2), '% of the time \n')
}
nba_pred('Charlotte Hornets', 'Orlando Magic', -13.5, 227.5)
nba_pred = function(home_team, away_team, spread = 0, total = 0) {
nba_data %>%
filter(Away == away_team) %>%
summarise(avg_pts_visit = sum(Away_Score)/n(),
avg_ptsa_visit = sum(Home_Score)/n()) -> away_data
nba_data %>%
filter(Home == home_team) %>%
summarise(avg_pts_home = sum(Home_Score)/n(),
avg_ptsa_home = sum(Away_Score)/n()) -> home_data
avg_pts_home_league <- mean(nba_data$Home_Score)
avg_pts_away_league <- mean(nba_data$Away_Score)
home_attack <- home_data$avg_pts_home/avg_pts_home_league
away_attack <- away_data$avg_pts_visit/avg_pts_away_league
home_defense <- home_data$avg_ptsa_home/avg_pts_away_league
away_defense <- away_data$avg_ptsa_visit/avg_pts_home_league
home_exp_pts <- home_attack * away_defense * avg_pts_home_league
away_exp_pts <- away_attack * home_defense * avg_pts_away_league
cat(home_team, 'expPts:', round(home_exp_pts, 0), ' ', away_team, 'expPts:', round(away_exp_pts, 0), '\n')
home_ml <- mean(rpois(10000, home_exp_pts) > rpois(10000, away_exp_pts))
away_ml <- mean(rpois(10000, home_exp_pts) < rpois(10000, away_exp_pts))
ml_tie <- mean(rpois(10000, home_exp_pts) == rpois(10000, away_exp_pts))/2
home_ml <- home_ml+ml_tie
away_ml <- away_ml+ml_tie
home_cover <- mean(rpois(10000, home_exp_pts) + spread > rpois(10000, away_exp_pts))
away_cover <- mean(rpois(10000, home_exp_pts) + spread < rpois(10000, away_exp_pts))
cover_tie <- mean(rpois(10000, home_exp_pts) + spread == rpois(10000, away_exp_pts))/2
home_cover <- home_cover + cover_tie
away_cover <- away_cover + cover_tie
over_prob <- mean(rpois(10000, home_exp_pts+away_exp_pts) > total)
under_prob <- mean(rpois(10000, home_exp_pts+away_exp_pts) < total)
total_tie <- mean(rpois(10000, home_exp_pts+away_exp_pts) == total)/2
over_prob <- over_prob + total_tie
under_prob <- under_prob + total_tie
cat(home_team, 'win', round(home_ml*100, 2), '% of the time \n')
cat(away_team, 'win', round(away_ml*100, 2), '% of the time \n')
cat(home_team, 'cover', spread, round(home_cover*100, 2), '% of the time \n')
cat(away_team, 'cover', spread*-1, round(away_cover*100, 2), '% of the time \n')
cat('Total goes over', round(over_prob*100, 2), '% of the time \n')
cat('Total goes under', round(under_prob*100, 2), '% of the time \n')
}
nba_pred('Milwaukee Bucks', 'Boston Celtics', -5.5, 227.5)
nba_pred('Toronto Raptors', 'Philadelphia 76ers', -1.5, 216.5)
nba_pred('Minnesota Timberwolves', 'San Antonio Spurs', -8.5, 237.5)
nba_pred('New Orleans Pelicans', 'Portland Trail Blazers', -16.5, 223.5)
nba_pred('Denver Nuggets', 'Memphis Grizzlies', -2.5, 233.5)
nba_pred('Golden State Warriors', 'Los Angeles Lakers', -12.5, 222.5)
mean(rnbinom(10000, 82, .73))
rnbinom(5, 82, .73)
rnbinom(n = 5, size = 82, prob = .73)
mean(rnbinom(n = 82, size = 1, prob = .73))
sd(c(3, -2.5, -2, 3.5, -3))
sd(c(3, -0.5, -2, 0.5, -3))
getwd()
setwd("~/GitHub/STAT_460_Project")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
player_data <- read.csv('final_df.csv') %>%
na.omit() %>%
select(-c(TM, POS, player_name, X))
colMeans(player_data)
player_data <- read.csv('final_df.csv') %>%
na.omit() %>%
select(-c(TM, X))
View(player_data)
center_data <- player_data %>%
filter(POS = 'C') %>%
select(-c(POS, player_name))
center_data <- player_data %>%
filter(POS == 'C') %>%
select(-c(POS, player_name))
center_data <- player_data %>%
filter(POS == 'C') %>%
select(-c(POS, player_name))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
library(dplyr)
library(car)
head(iris)
View(center_data)
center_data <- player_data %>%
filter(POS == 'C') %>%
select(-c(POS, player_name))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 4], center_data[ , 5], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[4], center_means[5], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE))
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 4], center_data[ , 5], xlab = "Raptor Offense", ylab = "Raptor Defense")
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE))
player_data[player_name == 'Nikola Jokic', ]
View(player_data)
player_data %>%
filter(player_name == 'Nikola Jokic') %>%
select(c(raptor_offense, raptor_defense))
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
jokic <- c(8.590943, 5.868475)
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE))
points(jokic, col = 'red')
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE))
points(8.590943, 5.868475, col = 'red')
?points
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE))
points(8.590943, 5.868475, col = 'red', lty = 'l')
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE))
points(8.590943, 5.868475, col = 'red', lty = l)
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'red')
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'red')
text(8.590943, 5.868475, 'Nikola Jokic')
?text
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'red')
text(8, 6, 'Jokic')
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'red')
text(9, 7, 'Jokic')
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'red')
text(8, 7, 'Jokic')
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'red')
text(8.5, 7, 'Jokic')
player_data %.%
\
ggplot()
player_data %.%
ggplot()
View(player_data)
View(center_data)
player_data %>%
filter(TM == 'PHI')
player_data <- read.csv('final_df.csv') %>%
na.omit()
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'red')
text(8.5, 7, 'Jokic')
player_data %>%
filter(TM == 'PHI')
player_data %>%
+ filter(TM == 'PHI') %>%
nrow()
player_data %>%
filter(TM == 'PHI') %>%
nrow()
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
center_data <- player_data %>%
filter(POS == 'C') %>%
select(c(raptor_offense, raptor_defense))
center_means <- colMeans(center_data)
center_cov <- cov(center_data)
n = dim(center_data)[1]
p = dim(center_data)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(center_data[ , 1], center_data[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(center_means[1], center_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = center_means, shape = center_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
title('Raptor Ratings for NBA Centers')
player_data %>%
select(c(raptor_offense, raptor_defense)) -> entire_nba
player_data %>%
select(c(raptor_offense, raptor_defense)) -> entire_nba
nba_means <- colMeans(entire_nba)
nba_cov <- cov(entire_nba)
n = dim(entire_nba)[1]
p = dim(entire_nba)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(entire_nba[ , 1], entire_nba[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(nba_means[1], nba_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = nba_means, shape = nba_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
title('Raptor Ratings for NBA Centers')
player_data %>%
select(c(raptor_offense, raptor_defense)) -> entire_nba
nba_means <- colMeans(entire_nba)
nba_cov <- cov(entire_nba)
n = dim(entire_nba)[1]
p = dim(entire_nba)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(entire_nba[ , 1], entire_nba[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(nba_means[1], nba_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = nba_means, shape = nba_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l', col = 'purple')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
title('Raptor Ratings for NBA Centers')
player_data %>%
select(c(raptor_offense, raptor_defense)) -> entire_nba
nba_means <- colMeans(entire_nba)
nba_cov <- cov(entire_nba)
n = dim(entire_nba)[1]
p = dim(entire_nba)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(entire_nba[ , 1], entire_nba[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(nba_means[1], nba_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = nba_means, shape = nba_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l', col = 'yellow')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
title('Raptor Ratings for NBA Centers')
player_data %>%
select(c(raptor_offense, raptor_defense)) -> entire_nba
nba_means <- colMeans(entire_nba)
nba_cov <- cov(entire_nba)
n = dim(entire_nba)[1]
p = dim(entire_nba)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(entire_nba[ , 1], entire_nba[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(nba_means[1], nba_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = nba_means, shape = nba_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l', col = 'pink')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
points(4.7, -0.9, col = 'yellow')
text(4.7, 0, 'Morant')
title('Raptor Ratings for NBA Centers')
player_data %>%
select(c(raptor_offense, raptor_defense)) -> entire_nba
nba_means <- colMeans(entire_nba)
nba_cov <- cov(entire_nba)
n = dim(entire_nba)[1]
p = dim(entire_nba)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(entire_nba[ , 1], entire_nba[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(nba_means[1], nba_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = nba_means, shape = nba_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l', col = 'pink')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
points(4.7, -0.9, col = 'lightblue')
text(4.7, 0, 'Morant')
title('Raptor Ratings for NBA Centers')
player_data %>%
select(c(raptor_offense, raptor_defense)) -> entire_nba
nba_means <- colMeans(entire_nba)
nba_cov <- cov(entire_nba)
n = dim(entire_nba)[1]
p = dim(entire_nba)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(entire_nba[ , 1], entire_nba[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(nba_means[1], nba_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = nba_means, shape = nba_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l', col = 'pink')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
points(4.7, -0.9, col = 'lightblue')
text(4.7, 0, 'Morant')
points(6, 0.9, col = 'blue')
text(6, 2, 'Curry')
title('Raptor Ratings for NBA Centers')
player_data %>%
select(c(raptor_offense, raptor_defense)) -> entire_nba
nba_means <- colMeans(entire_nba)
nba_cov <- cov(entire_nba)
n = dim(entire_nba)[1]
p = dim(entire_nba)[2]
alpha = 0.05
t_crit <- (n-1) * p / (n-p) * qf(p = 1-alpha, df1 = p, df2 = n-p)
plot(entire_nba[ , 1], entire_nba[ , 2], xlab = "Raptor Offense", ylab = "Raptor Defense")
points(nba_means[1], nba_means[2], pch = 4, cex = 1.3, col = "gray30")
points(ellipse(center = nba_means, shape = nba_cov, radius = sqrt(t_crit/n), draw = FALSE), type = 'l', col = 'pink')
points(8.590943, 5.868475, col = 'blue')
text(8.5, 7, 'Jokic')
points(3.9, 3.7, col = 'red')
text(3.9, 5, 'Embiid')
points(4.7, -0.9, col = 'lightblue')
text(4.7, 0, 'Morant')
points(6, 0.9, col = 'blue')
text(6, 2, 'Curry')
title('Raptor Ratings for NBA Players')
